@if (history().length > 0) {
<!-- Accordéon de l'historique -->
<div class="collapse collapse-arrow mb-6 rounded-lg">
  <input
    type="checkbox"
    class="collapse-toggle"
    [checked]="historyAccordionOpen()"
    (change)="toggleHistoryAccordion()"
  />
  <div class="collapse-title hover:bg-base-200 rounded-lg cursor-pointer">
    <h2 class="text-lg font-semibold flex items-center gap-2">
      <svg
        xmlns="http://www.w3.org/2000/svg"
        class="h-5 w-5 text-primary"
        fill="none"
        viewBox="0 0 24 24"
        stroke="currentColor"
        aria-hidden="true"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"
        />
      </svg>
      Récemment consultés
    </h2>
  </div>
  <div class="collapse-content">
    <ul class="w-full space-y-1" role="list">
      @for (event of history(); track event.ticketmasterId) {
      <li>
        <button
          (click)="navigateToEvent(event)"
          class="w-full px-2 py-2 hover:bg-base-200/50 rounded-md text-left border-0 bg-transparent cursor-pointer"
          [attr.title]="'Retourner sur l\'événement ' + getEventTitle(event)"
          [attr.aria-label]="
            'Retourner sur l\'événement ' + getEventTitle(event)
          "
          type="button"
        >
          <div class="flex gap-3 w-full min-w-0">
            @if (getEventImage(event)) {
            <div class="avatar">
              <div class="w-12 h-12 rounded-lg">
                <img
                  [src]="getEventImage(event)"
                  [alt]="'Image de l\'événement ' + getEventTitle(event)"
                  class="object-cover"
                />
              </div>
            </div>
            } @else {
            <div class="avatar placeholder">
              <div class="bg-neutral text-neutral-content rounded-lg w-12 h-12">
                <span class="text-xs">
                  {{ getEventTitle(event).charAt(0).toUpperCase() }}
                </span>
              </div>
            </div>
            }

            <div class="flex-1 min-w-0">
              <span
                class="font-semibold text-sm text-base-content truncate block"
              >
                {{ truncateText(getEventTitle(event), 25) }}
              </span>
              <span class="text-xs text-base-content/80 truncate block">
                {{ getEventLocation(event) }}
              </span>
              <span class="text-xs text-base-content/80 block">
                {{ formatDate(event) }}
              </span>
            </div>

            <div class="flex items-center">
              <svg
                aria-hidden="true"
                xmlns="http://www.w3.org/2000/svg"
                class="h-4 w-4 text-base-content/80"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"
                />
              </svg>
            </div>
          </div>
        </button>
      </li>
      }
    </ul>
  </div>
</div>
}
